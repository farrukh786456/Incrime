<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>How It Works ‚Äì InCrime</title>
<style>
  :root{
    --bg1:#eef6fb;
    --bg2:#ffffff;
    --accent:#0d2a3a;
    --gold:#FFD700;
    --card:#ffffff;
    --glass: rgba(255,255,255,0.6);
  }

  html,body{height:100%;margin:0;font-family:"Segoe UI",system-ui,-apple-system,SegoeUI,Roboto,"Helvetica Neue",Arial;}
  body{
    background: linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--accent);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  nav{
    display:flex;align-items:center;justify-content:space-between;
    padding:16px 56px;background:linear-gradient(90deg, rgba(13,42,58,0.95), rgba(13,42,58,0.95));
    color:#fff;position:sticky;top:0;z-index:50;box-shadow:0 6px 18px rgba(13,42,58,0.08);
  }
  .logo{font-weight:700;font-size:20px;letter-spacing:0.4px}
  nav ul{display:flex;gap:24px;list-style:none;margin:0;padding:0}
  nav a{color:#fff;text-decoration:none;opacity:0.95}
  nav a:hover{color:var(--gold)}

  .hero{
    text-align:center;padding:72px 10% 40px;
  }
  .hero h1{font-size:40px;margin:0 0 10px}
  .hero p{color:#2b3b45;margin:0 0 28px;font-size:17px}

  .grid{
    display:flex;gap:32px;justify-content:center;flex-wrap:wrap;padding:20px 6%;
    margin-bottom:60px;
  }

  .card{
    width:370px;min-height:220px;background:linear-gradient(180deg,rgba(255,255,255,0.9),var(--card));
    border-radius:16px;padding:28px;box-shadow:0 8px 30px rgba(8,20,30,0.08);
    transition:transform .38s cubic-bezier(.2,.9,.25,1),box-shadow .38s;cursor:pointer;position:relative;overflow:hidden;
    display:flex;flex-direction:column;justify-content:space-between;
  }
  .card:hover{transform:translateY(-10px);box-shadow:0 18px 46px rgba(8,20,30,0.12)}
  .card .icon{font-size:28px}
  .card h3{margin:12px 0 8px;font-size:20px}
  .card p{margin:0;color:#405660;line-height:1.4}
  .card .cta{
    margin-top:18px;align-self:flex-start;background:var(--gold);border:none;padding:10px 16px;border-radius:10px;font-weight:700;cursor:pointer;color:#06202a;
    box-shadow:0 6px 18px rgba(255,183,3,0.18);
  }

  /* overlay modal */
  .overlay{
    position:fixed;inset:0;display:none;place-items:center;background:linear-gradient(180deg,rgba(5,10,15,0.45),rgba(5,10,15,0.6));
    z-index:120;padding:32px;backdrop-filter: blur(5px);
  }
  .panel{
    width:min(1100px,98%);height:min(80vh,860px);background:linear-gradient(180deg,#fff,#fbfdff);
    border-radius:14px;box-shadow:0 30px 80px rgba(6,20,30,0.45);display:grid;grid-template-columns:420px 1fr;overflow:hidden;
  }

  /* left column - steps + small demo */
  .left{
    padding:24px 22px;border-right:1px solid rgba(10,20,25,0.04);background:linear-gradient(180deg, rgba(13,42,58,0.02), rgba(13,42,58,0.01));
    display:flex;flex-direction:column;gap:14px;
  }
  .left .mini-title{font-weight:700;color:var(--accent);font-size:18px}
  .steps{flex:1;overflow:auto;padding-right:6px}
  .step{
    background:linear-gradient(180deg,#ffffff,#f7fbff);padding:12px;border-radius:10px;margin-bottom:12px;border:1px solid rgba(8,20,30,0.04);
    opacity:0;transform:translateY(12px);transition:all .45s cubic-bezier(.2,.95,.25,1);
  }
  .step.show{opacity:1;transform:none}
  .step h4{margin:0 0 6px;font-size:15px}
  .step p{margin:0;color:#324b55;font-size:14px;line-height:1.45;white-space:pre-wrap}

  /* right column - large content area with animated reveal */
  .right{padding:28px;display:flex;flex-direction:column;gap:10px;}
  .right .header{display:flex;align-items:center;gap:12px}
  .right .title{font-size:20px;font-weight:700}
  .right .sub{color:#5a7680;font-size:13px}
  .content{
    margin-top:12px;flex:1;overflow:auto;padding-right:10px;
    background:linear-gradient(180deg, rgba(13,42,58,0.02), rgba(13,42,58,0.01));
    border-radius:10px;padding:18px;border:1px solid rgba(8,20,30,0.03);
  }

  /* content text styling */
  .content h3{margin-top:6px;margin-bottom:10px}
  .content p, .content li{color:#20343a;font-size:15px;line-height:1.6;white-space:pre-wrap}
  .content ol{padding-left:18px;margin:6px 0 12px}
  .content .reveal{opacity:0;transform:translateY(8px);transition:all .45s cubic-bezier(.2,.95,.25,1)}
  .content .reveal.show{opacity:1;transform:none}

  .close-x{position:absolute;right:16px;top:12px;cursor:pointer;background:transparent;border:none;font-size:22px;color:#12303a}

  /* footer */
  footer{padding:18px;text-align:center;background:linear-gradient(90deg,#0d2a3a,#0b2630);color:#fff;font-size:14px}

  /* scrollbar small */
  .steps::-webkit-scrollbar,.content::-webkit-scrollbar{width:8px}
  .steps::-webkit-scrollbar-thumb,.content::-webkit-scrollbar-thumb{background:linear-gradient(90deg,#ccdbe4,#a7c0cc);border-radius:8px}
  @media (max-width:980px){
    .panel{grid-template-columns:1fr; height:88vh}
    .left{display:none}
  }
</style>
</head>
<body>

<nav>
  <div class="logo">‚öñÔ∏è InCrime</div>
  <ul>
    <li><a href="#">Home</a></li>
    <li><a href="#">How It Works</a></li>
  </ul>
</nav>

<section class="hero">
  <h1>How InCrime Works</h1>
  <p>Click a card below to open the full technical "How it works" flow. Each step reveals in a smooth animated sequence.</p>
</section>

<div class="grid" role="list">
  <div class="card" onclick="openPanel('chatbot')">
    <div>
      <div class="icon">üß†</div>
      <h3>Chatbot Help</h3>
      <p>Opens the detailed step-by-step technical flow for the chatbot (session, NLU, slot filling, APIs).</p>
    </div>
    <button class="cta">Open Chatbot Flow</button>
  </div>

  <div class="card" onclick="openPanel('generator')">
    <div>
      <div class="icon">üßæ</div>
      <h3>Generate Application</h3>
      <p>Opens the detailed step-by-step technical flow for document generation and preview pipeline.</p>
    </div>
    <button class="cta">Open Generator Flow</button>
  </div>
</div>

<!-- Overlay / Panel -->
<div class="overlay" id="overlay">
  <div class="panel" role="dialog" aria-modal="true">
    <button class="close-x" onclick="closePanel()">‚úï</button>

    <!-- left: steps summary -->
    <div class="left" id="leftCol">
      <div class="mini-title" id="miniTitle">Flow Steps</div>
      <div class="steps" id="stepsList">
        <!-- steps inserted dynamically -->
      </div>
      <div style="font-size:13px;color:#4a6a73;padding-top:8px">Tip: Click any step on the left to jump to that section.</div>
    </div>

    <!-- right: full content -->
    <div class="right">
      <div class="header">
        <div>
          <div class="title" id="panelTitle">Title</div>
          <div class="sub" id="panelSub">Detailed technical working (step-by-step)</div>
        </div>
      </div>

      <div class="content" id="contentArea" tabindex="0" aria-live="polite">
        <!-- content injected dynamically -->
      </div>
    </div>

  </div>
</div>

<footer>¬© 2025 InCrime</footer>

<script>
/* Two long contents (verbatim as requested). We format them as HTML blocks. */
const chatbotHTML = `
<h3>üß† Chatbot Help ‚Äì How It Works</h3>
<p>The InCrime Chatbot is an interactive system designed to help users create legal applications and get guidance without needing expert help. It works step by step through a structured process that connects the frontend chatbot interface with the backend AI logic and database.</p>

<h3>üí¨ Step-by-Step Working (Detailed)</h3>

<ol>
<li>
  <strong>1. Start a Chat</strong>
  <p>When a user clicks on the ‚ÄúChatbot Help‚Äù button on the website:</p>
  <p>A chatbot window opens on the screen.</p>
  <p>The system automatically starts a new chat session by generating a unique session ID for that user.</p>
  <p>This session ID helps the backend track the entire conversation.</p>
  <p>A welcome message appears like ‚ÄúHello! I‚Äôm your legal assistant. How can I help you today?‚Äù</p>
  <p>So technically, this step initializes the chat interface and connects the user to the chatbot engine.</p>
</li>

<li>
  <strong>2. Ask or Select a Topic</strong>
  <p>Once the chat starts, the user can:</p>
  <p>Type their question manually (e.g., ‚ÄúHow do I write an FIR application?‚Äù), or</p>
  <p>Choose from predefined quick options such as:</p>
  <p>‚ÄúCreate an Application‚Äù</p>
  <p>‚ÄúKnow Required Documents‚Äù</p>
  <p>‚ÄúLegal Guidance‚Äù</p>
  <p>Here, the system uses Natural Language Understanding (NLU) to detect what the user is asking. If the user chooses a button, the chatbot directly identifies the intent. If the user types a question, the backend analyzes the text, detects keywords like ‚ÄúFIR‚Äù, ‚Äúcomplaint‚Äù, or ‚Äúproperty case‚Äù, and decides the most relevant topic.</p>
  <p>So in this step, user intent and case type are detected.</p>
</li>

<li>
  <strong>3. Chatbot Guides You</strong>
  <p>After understanding the intent, the chatbot starts a guided conversation. It asks the user simple, step-by-step questions such as:</p>
  <p>‚ÄúPlease enter your full name.‚Äù</p>
  <p>‚ÄúSelect your case type.‚Äù</p>
  <p>‚ÄúDescribe your case in a few lines.‚Äù</p>
  <p>Each answer the user gives is stored temporarily in the session memory (and saved to the database if needed). If the user types an invalid response (like leaving a field empty or typing a number instead of text), the chatbot asks again ‚Äî this is input validation.</p>
  <p>So this step works like an interactive form, where data is collected gradually through chat messages.</p>
</li>

<li>
  <strong>4. Get Instant Answers</strong>
  <p>Once enough information is collected, the chatbot automatically generates a reply using the stored data. Depending on what the user asked, it performs one of these actions:</p>
  <p>If the user requested legal guidance, it retrieves predefined legal information or AI-generated advice.</p>
  <p>If the user asked for required documents, it checks the case type and shows a list (e.g., ‚ÄúFor an FIR, you need CNIC copy, written statement, and witness details.‚Äù).</p>
  <p>If the user wants to create an application, it passes all collected details to the ‚ÄúGenerate Your Application‚Äù tool.</p>
  <p>At this stage, the chatbot and backend are connected ‚Äî the backend uses the user‚Äôs answers to prepare structured data for the next process.</p>
</li>

<li>
  <strong>5. Automatic Form Filling</strong>
  <p>If the user chooses to generate a legal application, the chatbot sends all collected answers (like name, case type, details, etc.) directly to the application generator form.</p>
  <p>This is done through an API or a data transfer call:</p>
  <p>The chatbot sends data to the form as JSON.</p>
  <p>The ‚ÄúGenerate Your Application‚Äù page receives this data and automatically fills in all fields.</p>
  <p>The user can then view the live-generated document and make changes if needed.</p>
  <p>So this step is basically data handover between the chatbot and the document generator.</p>
</li>

<li>
  <strong>6. Always Here to Help</strong>
  <p>During or after the process:</p>
  <p>The chatbot keeps the chat session active for a fixed time (like 24 hours).</p>
  <p>The user can return later and continue from where they left off ‚Äî the session data is restored from the database.</p>
  <p>If the chatbot cannot understand the question or if the user requests human help, the system automatically forwards the chat to a human legal advisor or admin support.</p>
  <p>So this step ensures continuous help and chat memory, allowing users to stay guided throughout their case creation.</p>
</li>
</ol>
`;

const generatorHTML = `
<h3>üìù Generate Your Application ‚Äì How It Works</h3>
<p>The ‚ÄúGenerate Your Application‚Äù feature in InCrime automatically creates professional legal documents based on the answers provided by the user (either through the chatbot or direct form entry). It combines an interactive form system, AI-based text generation, and a document rendering engine to prepare the final application instantly.</p>

<h3>‚öôÔ∏è Step-by-Step Working (Detailed)</h3>

<ol>
<li>
  <strong>1. User Enters the Generate Section</strong>
  <p>When the user clicks on the ‚ÄúGenerate Your Application‚Äù button:</p>
  <p>The frontend loads the ‚ÄúApplication Generator‚Äù interface.</p>
  <p>If the user came from the chatbot, the system already has their collected information (like name, case type, and description).</p>
  <p>A new generation session starts, identified by a unique application_id stored in the backend.</p>
  <p>So this step initializes the generator page and prepares to receive user data.</p>
</li>

<li>
  <strong>2. Data Input and Case Type Selection</strong>
  <p>Once the page loads:</p>
  <p>The user either manually enters details or the system auto-fills them (from chatbot data).</p>
  <p>The system asks for step-by-step details such as:</p>
  <ul>
    <li>Full Name</li>
    <li>CNIC (optional)</li>
    <li>Case Type (e.g., FIR, Complaint, Property Dispute, etc.)</li>
    <li>Description of Case or Incident</li>
    <li>Relief or Action Requested</li>
  </ul>
  <p>Each input is saved automatically (auto-save system) after every change ‚Äî so no data is lost even if the user refreshes the page.</p>
</li>

<li>
  <strong>3. Field Validation</strong>
  <p>As the user fills in the information:</p>
  <p>Each input is checked using frontend validation (for empty fields, invalid CNIC format, etc.).</p>
  <p>After validation, the data is also verified on the backend for accuracy and safety.</p>
  <p>This ensures the final application is complete and free of missing information.</p>
  <p>For example:</p>
  <p>If the ‚ÄúCase Description‚Äù is too short, the system asks the user to write more detail.</p>
  <p>If the ‚ÄúName‚Äù contains invalid characters, it shows an error message immediately.</p>
</li>

<li>
  <strong>4. Live Preview Creation</strong>
  <p>After the user starts filling the form, the system dynamically creates a live preview of the application on the same page.</p>
  <p>Here‚Äôs how it works:</p>
  <p>The form data is merged into a predefined application template (based on the selected case type).</p>
  <p>The right side of the page shows a real-time typing animation or live document preview, where users can see their information appear inside the legal format.</p>
  <p>For example:</p>
  <p>‚ÄúTo,</p>
  <p>The Station House Officer,</p>
  <p>City Police Station,</p>
  <p>Subject: Application for FIR...‚Äù</p>
  <p>(Automatically continues using the user‚Äôs answers)</p>
  <p>This live preview helps the user visualize the final document instantly as they type.</p>
</li>

<li>
  <strong>5. Backend Processing and Auto Text Generation</strong>
  <p>When all inputs are complete:</p>
  <p>The frontend sends the user‚Äôs data (in JSON format) to the backend API endpoint, e.g. /applications/generate.</p>
  <p>The backend:</p>
  <ol>
    <li>Retrieves the correct template based on the case type.</li>
    <li>Inserts user details into placeholders (like Name, Address, Case Details, etc.).</li>
    <li>Adds professional legal phrasing automatically using AI rules or stored templates.</li>
  </ol>
  <p>This converts simple user answers into a well-written, official-style legal application.</p>
</li>

<li>
  <strong>6. Document Formatting</strong>
  <p>After the content is generated, the backend formats the entire text into a professional layout:</p>
  <p>Adds proper margins, spacing, and alignment.</p>
  <p>Inserts the user‚Äôs name and date at the bottom.</p>
  <p>Ensures the application follows the correct structure (address, subject, body, closing).</p>
  <p>Converts everything into a final printable layout.</p>
  <p>This step ensures the document looks like a proper court or police application.</p>
</li>

<li>
  <strong>7. Review and Editing</strong>
  <p>Once the preview is ready:</p>
  <p>The user can scroll through the generated document on-screen.</p>
  <p>They can edit any field (like changing their name, modifying details, or adding extra lines).</p>
  <p>Any change made instantly updates both the form and the preview.</p>
  <p>So this step gives full control to the user before finalizing the application.</p>
</li>

<li>
  <strong>8. Document Generation</strong>
  <p>When the user clicks ‚ÄúGenerate PDF‚Äù or ‚ÄúDownload Application‚Äù:</p>
  <p>The frontend sends a final request to the backend with all form data.</p>
  <p>The backend creates a final version of the document:</p>
  <ul>
    <li>Converts it into PDF or Word (.docx) format using a rendering engine.</li>
    <li>Stores a copy on the server (for record purposes).</li>
    <li>Returns a download link or auto-downloads the file.</li>
  </ul>
  <p>At this point, the legal application is fully generated and ready to print or share.</p>
</li>

<li>
  <strong>9. Save and Reopen</strong>
  <p>Every generated file and its data are linked to the user‚Äôs account or session ID.</p>
  <p>If the user returns later, they can open ‚ÄúMy Applications‚Äù and view, edit, or re-download their old documents.</p>
  <p>The system keeps saved versions (e.g., Draft ‚Üí Final ‚Üí Updated).</p>
  <p>So this ensures users never lose their progress and can reuse their documents anytime.</p>
</li>

<li>
  <strong>10. Integration with Chatbot</strong>
  <p>If the user came from the chatbot:</p>
  <p>The chatbot automatically sends all the answers it collected (like name, case type, case details) to this generator.</p>
  <p>The generator then auto-fills the form instantly ‚Äî the user just reviews and clicks ‚ÄúGenerate‚Äù.</p>
  <p>This seamless transfer reduces typing and speeds up document creation.</p>
</li>
</ol>
`;

/* Utility to split content into left-side steps for quick navigation */
function buildSteps(htmlString){
  // We'll find the top-level <ol> in the provided HTML and extract the <li> innerText to show as steps.
  const wrapper = document.createElement('div'); wrapper.innerHTML = htmlString;
  const ol = wrapper.querySelector('ol');
  const lis = ol ? Array.from(ol.querySelectorAll('> li')) : [];
  return lis.map((li, idx) => ({ title: li.querySelector('strong') ? li.querySelector('strong').innerText : 'Step ' + (idx+1), content: li.innerHTML }));
}

let currentMode = null;
const overlay = document.getElementById('overlay');
const contentArea = document.getElementById('contentArea');
const leftCol = document.getElementById('leftCol');
const stepsList = document.getElementById('stepsList');
const panelTitle = document.getElementById('panelTitle');
const panelSub = document.getElementById('panelSub');

/* show overlay with either 'chatbot' or 'generator' content */
function openPanel(mode){
  currentMode = mode;
  overlay.style.display = 'grid';

  // choose content
  let title, sub, html;
  if(mode === 'chatbot'){
    title = 'Chatbot Help ‚Äî Working';
    sub = 'Session, NLU, Dialog, Slot Filling, APIs';
    html = chatbotHTML;
  } else {
    title = 'Generate Your Application ‚Äî Working';
    sub = 'Form, Preview, Rendering, PDF/DOCX';
    html = generatorHTML;
  }

  panelTitle.innerText = title;
  panelSub.innerText = sub;

  // fill left steps
  const steps = buildSteps(html);
  stepsList.innerHTML = '';
  steps.forEach((s, i) => {
    const div = document.createElement('div');
    div.className = 'step';
    div.innerHTML = `<h4>${i+1}. ${s.title}</h4><p>${(s.content||'').replace(/<[^>]+>/g,'').slice(0,180)}${(s.content||'').length>180?'...':''}</p>`;
    div.addEventListener('click',() => jumpToStep(i));
    stepsList.appendChild(div);
    // animate entry
    setTimeout(()=>div.classList.add('show'), 80*i + 120);
  });

  // fill right content (split into paragraphs for reveal)
  contentArea.innerHTML = html;

  // reveal children sequentially for animation
  const children = Array.from(contentArea.querySelectorAll('h3, p, ol, ul, li'));
  children.forEach((el, idx) => {
    el.classList.add('reveal');
    setTimeout(()=>el.classList.add('show'), 60*idx + 160);
  });

  // ensure focus for keyboard users
  setTimeout(()=>contentArea.focus(), 300);
}

/* close overlay */
function closePanel(){
  overlay.style.display = 'none';
  // clear left steps quickly
  stepsList.innerHTML = '';
  contentArea.innerHTML = '';
}

/* jump to a step index by scrolling content to that step's heading */
function jumpToStep(index){
  const ols = contentArea.querySelectorAll('ol');
  if(ols.length === 0) return;
  const lis = ols[0].querySelectorAll('> li');
  if(index >= lis.length) return;
  const target = lis[index];
  // scroll contentArea to target
  const rectPanel = contentArea.getBoundingClientRect();
  const rectTarget = target.getBoundingClientRect();
  const offset = rectTarget.top - rectPanel.top + contentArea.scrollTop - 18;
  contentArea.scrollTo({top: offset, behavior: 'smooth'});
  // subtle highlight
  target.style.transition = 'background .25s';
  target.style.background = 'linear-gradient(90deg, rgba(255,235,179,0.35), rgba(255,255,255,0))';
  setTimeout(()=>target.style.background = 'transparent', 900);
}

/* close when clicking outside panel (but not on panel itself) */
overlay.addEventListener('click', (e) => {
  if(e.target === overlay) closePanel();
});

/* keyboard escape to close */
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape' && overlay.style.display === 'grid') closePanel();
});
</script>
</body>
</html>
